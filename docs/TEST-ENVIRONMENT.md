# 테스트 환경 구축 가이드

**Last Updated**: 2026-01-07

개발 및 테스트를 위한 샘플 데이터 환경 구축 방법을 설명합니다.

---

## 빠른 시작

```bash
npx tsx scripts/setup-test-environment.ts
```

이 스크립트는 다음을 자동으로 생성합니다:
- 테스트 법무법인 (tenant)
- 변호사 2명 + 직원 1명 계정
- 테스트 의뢰인 3명
- 44개 테스트 사건 (모든 사건 유형 포함)

---

## 생성되는 테스트 계정

| 역할 | 이메일 | 비밀번호 | 이름 | 권한 |
|------|--------|---------|------|------|
| **Owner (관리자)** | owner@testlaw.kr | test1234! | 김대표 | 전체 관리 권한 |
| Lawyer | lawyer@testlaw.kr | test1234! | 박변호 | 사건/의뢰인 관리 |
| Staff | staff@testlaw.kr | test1234! | 이직원 | 제한된 조회 권한 |

---

## 테스트 사건 목록 (44건)

### 사건 유형별 분류

| 카테고리 | 사건유형 | 건수 |
|---------|---------|------|
| 민사 | 가단, 가소, 가합, 나, 다, 머 | 6건 |
| 가사 | 드단, 드합, 느단, 느합, 르, 므, 너, 즈단, 즈합, 즈기, 브 | 11건 |
| 형사 | 고단, 고합, 노, 도 | 4건 |
| 행정 | 구단, 구합, 누, 두, 아 | 5건 |
| 신청/보전 | 카기, 카단, 카합, 카불, 카확, 카정, 카소, 카명, 카담 | 9건 |
| 집행 | 타채, 타배 | 2건 |
| 전자독촉 | 차전 | 1건 |
| 회생/파산 | 개회, 하단, 하면 | 3건 |
| 보호 | 동버 | 1건 |
| 감치 | 정명 | 1건 |
| 항고 | 스 | 1건 |

### 데이터 소스

테스트 사건 목록: `data/scourt-test-cases.json`

모든 사건은 대법원 나의사건검색에서 실제로 조회 가능한 공개 사건입니다.

---

## 스크립트 상세

### 실행 흐름

```
1. 기존 테스트 데이터 정리 (test-law-firm-* 슬러그)
2. Supabase Auth 사용자 생성 (3명)
3. 테스트 법무법인 생성 (professional 플랜)
4. 멤버십 연결 (owner, lawyer, staff)
5. 테스트 의뢰인 생성 (3명)
6. 44개 사건 등록
```

### 환경변수 요구사항

`.env.local` 파일에 다음이 필요합니다:

```env
NEXT_PUBLIC_SUPABASE_URL=https://xxx.supabase.co
SUPABASE_SERVICE_ROLE_KEY=eyJxxx...
```

### 재실행

스크립트를 재실행하면 기존 테스트 데이터가 자동으로 삭제되고 새로 생성됩니다.

```bash
# 기존 데이터 삭제 후 새로 생성
npx tsx scripts/setup-test-environment.ts
```

---

## 테스트 시나리오

### 1. 로그인 테스트

```
1. http://localhost:3000 접속
2. owner@testlaw.kr / test1234! 로 로그인
3. 대시보드에서 44개 사건 확인
```

### 2. 권한 테스트

```
1. staff@testlaw.kr 로 로그인
2. 사건 조회는 가능하나 삭제/설정 변경 불가 확인
```

### 3. SCOURT 연동 테스트

```
1. 사건 상세 페이지에서 "SCOURT 동기화" 버튼 클릭
2. 캡챠 입력 후 일반내용/진행내용 조회 확인
```

---

## 주의사항

### 프로덕션 환경 금지

⚠️ 이 스크립트는 **개발/테스트 환경 전용**입니다.
프로덕션 데이터베이스에서 실행하지 마세요.

### 중복 실행

스크립트 재실행 시 기존 `test-law-firm-*` 슬러그의 테넌트와 관련 데이터가 삭제됩니다.

### 사용자 삭제

테스트 사용자 이메일 (`*@testlaw.kr`)이 이미 존재하면 삭제 후 재생성됩니다.

---

## 관련 파일

| 파일 | 설명 |
|------|------|
| `scripts/setup-test-environment.ts` | 테스트 환경 구축 스크립트 |
| `data/scourt-test-cases.json` | 44개 테스트 사건 목록 |
| `lib/auth/lawyer-registration.ts` | 실제 회원가입 로직 (참고용) |

---

## 변경 이력

| 날짜 | 내용 |
|------|------|
| 2026-01-07 | 최초 작성, 44개 테스트 사건 포함 |
